# Отключить `xmlrpc.php`

[Проверка подключения XML-RPC к WP](http://xmlrpc.epizy.com/ ) - WordPress XML-RPC Validation

Это протокол для работы внешних приложений. Например, официальное приложение WordPress 
для iPhone или какие-то собственные скрипты. Но у этого файла есть 2 уязвимости:

1. С помощью **Pingback** злоумышленники могут организовать **DDOS-атаку** на сайт.
2. Запустить **перебор паролей (брутфорс)** с помощью метода `wp.getUsersBlogs`.

Если файл доступен и доступны эти методы — на сайт может выполняться DDOS-атака, либо подбор пароля.

В 99% случаев вам не нужен этот файл и лучше xml-rpc.php отключить.


## Широко применяемый метод (отключает только часть методов XML-RPC)

Фильтрует, включены ли методы XML-RPC, требующие проверки подлинности.

```php
add_filter( 'xmlrpc_enabled', '__return_false' ); 
```
– отключает только часть определенного пространства методов XML-RPC. Вопреки своему названию, 
`xmlrpc_enabled` этот фильтр не контролирует, включен ли XML-RPC полностью , а только контролирует, 
включены ли методы XML-RPC, требующие проверки подлинности, например, для целей публикации.

Кроме того, фильтр не контролирует, включены ли pingbacks или другие настраиваемые конечные точки, 
не требующие аутентификации. 


# Полностью отключаем XML-RPC

Вы можете безопасно использовать оба нижеприведнных метода. Они не будут мешать друг другу, и у вас 
будет глубокая защита на случай, если один из них будет случайно удален. 


## Отменяем регистрацию всего пространства методов XML-RPC из functions.php

Эта техника цепляет xmlrpc_methodsfilter и очищает пространство метода во время выполнения:

```php
// disable xmlrpc
function remove_xmlrpc_methods( $methods ) {
  return array();
}
add_filter( 'xmlrpc_methods', 'remove_xmlrpc_methods' );
```

Любой последующий запрос любого метода вернет объект ошибки XML-RPC, информирующий «запрошенный 
метод не существует». Его легко развернуть в файле functions.php . 


## Полностью закрываем доступ к файлу `xmlrpc.php` через .htaccess`

Несмотря на то, что мы отключаем через фильтры работу `xmlrpc.php`, на него все равно 
могут идти атаки. Получить какие-то данные или подобрать пароли у злоумышленников не получится, 
так как все методы в этом файле мы отключаем. Но такие атаки создают ненужную нагрузку на сервер.

В 99% случаев вам ничего не нужно делать и никакой нагрузки вы не заметите. Плюс сами хостеры 
борются с этой проблемой, ограничивая доступ к файлу.

Но, если у вас все таки выросла нагрузка на сервер, вы или хостер определили, что идет атака 
на `xmlrpc.php`, можно полностью закрыть доступ к файлу `xmlrpc.php` через `.htaccess`. Найдите в корне 
вашего сайта файл `.htaccess` и добавьте в него следующие строчки:

 ```
<Files xmlrpc.php>
Order Allow,Deny
Deny from all
</Files>
``` 

С помощью этих правил мы полностью закрываем доступ к файлу.


# Другие службы удаленного доступа (не XML-RPC)


## Удаляем `wlwmanifest` в WordPress

Ссылка wlw manifest – это возможность редактировать и изменять статьи на сайте WordPress при помощи 
программы Windows Live Writer.

Так выглядит `link` в коде:

```html
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://wpcourses.ru/wp-includes/wlwmanifest.xml" />
```

Убираем `link` с помощью код: при помощи кода в файле function.php можно отключить вывод wlw manifest.

```php
remove_action( 'wp_head', 'wlwmanifest_link' );
```


## Отключение настройки публикации по email

```php
// отключение настройки публикации по email start   
add_filter('enable_post_by_email_configuration', '__return_false');
```

