# Загоовки безопасности | SecurityHeaders

## Category: Security Headers от Really Simple SSL

(Category: Security Headers)(https://really-simple-ssl.com/security-headers/)

(Protecting site visitors with Security Headers - Защита посетителей сайта с помощью заголовков безопасности)(https://really-simple-ssl.com/protecting-site-visitors-with-security-headers/)

[Configuring recommended Security Headers | Настройка рекомендуемых заголовков безопасности](https://really-simple-ssl.com/instructions/about-recommended-security-headers/)

[Manually adding recommended security headers on WordPress | Добавление рекомендуемых заголовков безопасности вручную в WordPress](https://really-simple-ssl.com/site-health-recommended-security-headers/)

]What are Frame Ancestors? | Что такое Frame Ancestors?](https://really-simple-ssl.com/definition/what-are-frame-ancestors/)

W3 Total Cache and Security Headers

How to set Security Headers on Apache and NGINX

How to find where (unwanted) security headers are set

How to use the Permission Policy header

Getting everything out of your security headers

How to use the Content Security Policy generator

Inserting HSTS header using PHP

HSTS: HTTP Strict Transport Security, and why it’s good to have it

## Расположение заголовков безопасности

По сути, есть три места, где можно установить заголовки безопасности для вашего веб-сайта WordPress, и последний установленный заголовок является активным. Порядок установки заголовков следующий:

- Плагины или файлы PHP (например, wp-config.php, function.php или плагин типа Really Simple SSL)
- Файлы конфигурации сервера (.htaccess, httpd.conf, nginx.conf)
- Прокси-серверы или службы сети доставки контента, такие как Cloudflare

### Плагины или файлы PHP

Существуют плагины, которые устанавливают заголовки в свои собственные файлы PHP, в wp-config.php или в файл function.php вашей темы. Если вы не можете найти, где были установлены заголовки безопасности, вы можете проверить эти файлы на наличие строк, устанавливающих эти заголовки. Примечание. Если вы не можете найти заголовок в wp-config.php или function.php, возможно, заголовок установлен внутри плагина. Затем вам нужно будет изменить настройку или удалить этот плагин, чтобы предотвратить повторное появление заголовка безопасности.

Apache и Litespeed

Если ваш сайт использует Apache, вам нужно будет найти файл .htaccess* в корневой папке вашего сайта. Для этого вы можете использовать плагин файлового менеджера. Откройте файл в режиме редактирования и найдите строку, начинающуюся с «заголовок (всегда) установлен», за которой следует заголовок, который вы хотите удалить, и удалите всю строку.

Примечание. Если вы не установили заголовок в .htaccess самостоятельно, возможно, это было сделано с помощью плагина. В этом случае вам нужно будет изменить настройку или удалить этот плагин, чтобы предотвратить повторное появление заголовка безопасности в .htaccess. Если заголовок безопасности не установлен в .htaccess, он может быть установлен в файле httpd.conf. На платформах общего хостинга у вас не будет доступа к файлу httpd.conf, и вам придется попросить вашего веб-хостера удалить установленные заголовки безопасности. в этом файле.

### Nginx 

Файлы конфигурации Nginx могут находиться в разных местах. На платформах общего хостинга у вас не будет доступа к файлам nginx.conf, и вам придется попросить вашего веб-хостера удалить заголовки безопасности, установленные в этих файлах.

### Cloudflare

В Cloudflare существует много разных способов установки заголовков безопасности. Есть работники Cloudflare, правила преобразования, настройки сертификатов и еще несколько непонятных способов. Если у вас есть нежелательные заголовки безопасности, установленные Cloudflare, проверьте этот URL-адрес , чтобы найти документацию о том, где их можно установить.

*В некоторых конфигурациях возможно, что .htaccess не доступен для прямой записи. На панели Really Simple SSL появится ошибка. Вы можете решить эту проблему, прочитав эту статью . Если вы следовали этой статье, перезагрузите панель управления, и уведомление должно исчезнуть.


## Добавление рекомендуемых заголовков безопасности вручную в WordPress

### Adding HSTS

```
# Really Simple SSL
Header always set Strict-Transport-Security: "max-age=31536000" env=HTTPS 
# End Really Simple SSL
```

Чтобы удалить HSTS. Установите  "max-age=0"

### Adding X-XSS-Protection

```
# Really Simple SSL
Header always set X-XSS-Protection "0"
# End Really Simple SSL
```

### Adding X-Content-Type-Options

```
# Really Simple SSL
Header always set X-Content-Type-Options "nosniff"
# End Really Simple SSL
```

### Adding Referrer Policy header

```
# Really Simple SSL
Header always set Referrer-Policy "strict-origin-when-cross-origin" 
# End Really Simple SSL
```

### Adding X-Frame-Options header

```
# Really Simple SSL
Header always set X-Frame-Options: "SAMEORIGIN"
# End Really Simple SSL
```

### Adding Permissions-Policy header

```
# Really Simple SSL
Header always set Permissions-Policy: "" 
# End Really Simple SSL
```


## Настройка рекомендуемых заголовков безопасности 2022

Возможные и рекомендуемые конфигурации для четырех рекомендуемых заголовков безопасности в **Really Simple SSL Pro**

### X-XSS-Protection

Этот заголовок использовался для управления защитой от межсайтовых сценариев в браузерах. Старые браузеры имели встроенную защиту XSS, 
которая фильтровала небезопасные скрипты. Все основные браузеры теперь удалили защиту от XSS и фильтрацию скриптов. 
Если для этого заголовка установлено значение «0», даже старым браузерам будет предложено отключить функции защиты XSS, 
поскольку они, как известно, открывают новые возможности для атак с утечкой информации между сайтами.

**Рекомендуемое значение:** 0 (для всех сайтов) 

### X-Content-Type options

Этот заголовок защищает посетителей сайта от так называемых «атак с попутной загрузкой», когда вредоносный 
код может быть «замаскирован» под обычный загружаемый контент.

**Рекомендуемое значение:** allow (разрешить для всех сайтов). 

### Referrer Policy

Политика реферера будет указывать браузеру, какая информация о реферере включается при переходе на другую 
страницу или веб-сайт. Информация о реферере состоит из URL-адреса, который посетил посетитель перед страницей, 
на которую переходит посетитель, включая любые возможные параметры. Пересылка этой информации может стать проблемой 
безопасности и конфиденциальности при пересылке на незащищенный (HTTP) сайт или когда в параметры включена к
онфиденциальная информация.

**Рекомендуемое значение:**
- `strict-origin-when-cross-origin` (отправляет параметры только внутри собственного домена и отправляет ссылающийся 
домен только на внешние сайты, загружающиеся по HTTPS)

**В зависимости от вашей конфигурации:**
- `no-referrer-when-downgrade` (актуально, если вы включили на свой сайт партнерские ссылки, использующие параметры. Они будут отправляться только тогда, когда внешний сайт загружается через HTTPS.)
- `same-origin` (**того же происхождения** - если вы хотите, чтобы ссылающиеся страницы и параметры обменивались только внутри вашего сайта. На внешние сайты ничего не отправляется.) 

### X-Frame options

Этот заголовок сообщит браузеру посетителя, разрешить ли загрузку сайта или страницы в iFrame. iFrames обычно используются как метод, позволяющий посетителям сайта поверить, что они находятся на веб-сайте, хотя на самом деле они находятся на вредоносном сайте. Таким образом, можно обманом заставить ввести конфиденциальную информацию или перейти по ссылкам.

Этот заголовок должен быть установлен как можно более строго. Поскольку большинство конструкторов страниц загружают ваш сайт в iFrame, полное отключение iFrame, скорее всего, приведет к поломке редактора вашего конструктора страниц. Вот почему значением по умолчанию, установленным Really Simple SSL Pro, является «SELF».

Рекомендуемое значение:
- `SAMEORIGIN` (для сайтов, использующих конструкторы страниц)
- `DENY` (**ЗАПРЕТИТЬ** если вы не используете конструкторы страниц или не используете iFrames своего сайта).
- `ALLOW` (**РАЗРЕШИТЬ** если вам известен внешний сайт, которому необходимо загрузить сайт в iFrame)

**Обратите внимание:** если для этого заголовка установлено значение ALLOW, мы настоятельно рекомендуем указать сайты, 
которым разрешено загружать сайт в iFrame, используя заголовок Frame-ancestors в CSP (политики безопасности контента). 


## Что такое Frame-ancestors в CSP — похож на заголовок X-Frame-Options

Frame-ancestors — это одна из директив заголовка Content-Security-Policy. Это позволяет администраторам веб-сайтов 
определять, могут ли сайт или страница быть встроены в другой сайт (например, загружены в iFrame).

Директива Frame-ancestors имеет очень похожую функцию, что и заголовок X-Frame-Options. В отличие от заголовков X-Frame-Options, 
которые теперь поддерживают только запрет или разрешение встраивания того же источника, директива Frame-ancestors имеет 
параметры для указания конкретных источников и используемых схем, которым разрешено встраивать ваш сайт.

Мы рекомендуем установить оба заголовка, чтобы обеспечить максимальную совместимость и безопасность во всех браузерах. 
Очень старые браузеры могут не поддерживать директиву Frame-ancestors Content-Security-Policy.

Параметры

Директива Frame-ancestors предоставляет следующие настройки:
- **Self:** разрешает загрузку страницы в iFrame только из того же домена.
- **None:** вообще не позволяет загружать страницу в iFrame.
- **URI:** если указаны определенные домены, заголовок CSP позволит загружать страницу в iFrame только в указанных доменах. 

